{"version":3,"file":"Hitalk.es.js","sources":["../src/detect.js","../src/utils.js","../src/Hitalk.js"],"sourcesContent":["var win = window || {}\nvar nav = navigator || {}\nfunction Detect(userAgent) {\n  var u = userAgent || nav.userAgent\n  var _this = this\n\n  var match = {\n    //内核\n    Trident: u.indexOf('Trident') > -1 || u.indexOf('NET CLR') > -1,\n    Presto: u.indexOf('Presto') > -1,\n    WebKit: u.indexOf('AppleWebKit') > -1,\n    Gecko: u.indexOf('Gecko/') > -1,\n    //浏览器\n    Safari: u.indexOf('Safari') > -1,\n    Chrome: u.indexOf('Chrome') > -1 || u.indexOf('CriOS') > -1,\n    IE: u.indexOf('MSIE') > -1 || u.indexOf('Trident') > -1,\n    Edge: u.indexOf('Edge') > -1,\n    Firefox: u.indexOf('Firefox') > -1 || u.indexOf('FxiOS') > -1,\n    'Firefox Focus': u.indexOf('Focus') > -1,\n    Chromium: u.indexOf('Chromium') > -1,\n    Opera: u.indexOf('Opera') > -1 || u.indexOf('OPR') > -1,\n    Vivaldi: u.indexOf('Vivaldi') > -1,\n    Yandex: u.indexOf('YaBrowser') > -1,\n    Kindle: u.indexOf('Kindle') > -1 || u.indexOf('Silk/') > -1,\n    '360': u.indexOf('360EE') > -1 || u.indexOf('360SE') > -1,\n    UC: u.indexOf('UC') > -1 || u.indexOf(' UBrowser') > -1,\n    QQBrowser: u.indexOf('QQBrowser') > -1,\n    QQ: u.indexOf('QQ/') > -1,\n    Baidu: u.indexOf('Baidu') > -1 || u.indexOf('BIDUBrowser') > -1,\n    Maxthon: u.indexOf('Maxthon') > -1,\n    Sogou: u.indexOf('MetaSr') > -1 || u.indexOf('Sogou') > -1,\n    LBBROWSER: u.indexOf('LBBROWSER') > -1,\n    '2345Explorer': u.indexOf('2345Explorer') > -1,\n    TheWorld: u.indexOf('TheWorld') > -1,\n    XiaoMi: u.indexOf('MiuiBrowser') > -1,\n    Quark: u.indexOf('Quark') > -1,\n    Qiyu: u.indexOf('Qiyu') > -1,\n    Wechat: u.indexOf('MicroMessenger') > -1,\n    Taobao: u.indexOf('AliApp(TB') > -1,\n    Alipay: u.indexOf('AliApp(AP') > -1,\n    Weibo: u.indexOf('Weibo') > -1,\n    Douban: u.indexOf('com.douban.frodo') > -1,\n    Suning: u.indexOf('SNEBUY-APP') > -1,\n    iQiYi: u.indexOf('IqiyiApp') > -1,\n    //系统或平台\n    Windows: u.indexOf('Windows') > -1,\n    Linux: u.indexOf('Linux') > -1 || u.indexOf('X11') > -1,\n    'Mac OS': u.indexOf('Macintosh') > -1,\n    Android: u.indexOf('Android') > -1 || u.indexOf('Adr') > -1,\n    Ubuntu: u.indexOf('Ubuntu') > -1,\n    FreeBSD: u.indexOf('FreeBSD') > -1,\n    Debian: u.indexOf('Debian') > -1,\n    'Windows Phone': u.indexOf('IEMobile') > -1 || u.indexOf('Windows Phone') > -1,\n    BlackBerry: u.indexOf('BlackBerry') > -1 || u.indexOf('RIM') > -1,\n    MeeGo: u.indexOf('MeeGo') > -1,\n    Symbian: u.indexOf('Symbian') > -1,\n    iOS: u.indexOf('like Mac OS X') > -1,\n    'Chrome OS': u.indexOf('CrOS') > -1,\n    WebOS: u.indexOf('hpwOS') > -1,\n    //设备\n    Mobile: u.indexOf('Mobi') > -1 || u.indexOf('iPh') > -1 || u.indexOf('480') > -1,\n    Tablet: u.indexOf('Tablet') > -1 || u.indexOf('Pad') > -1 || u.indexOf('Nexus 7') > -1\n  }\n  //修正\n  if (match['Mobile']) {\n    match['Mobile'] = !(u.indexOf('iPad') > -1)\n  } else if (win.showModalDialog && win.chrome) {\n    match['360'] = true\n  }\n  //基本信息\n  var hash = {\n    engine: ['WebKit', 'Trident', 'Gecko', 'Presto'],\n    browser: [\n      'Safari',\n      'Chrome',\n      'Edge',\n      'IE',\n      'Firefox',\n      'Firefox Focus',\n      'Chromium',\n      'Opera',\n      'Vivaldi',\n      'Yandex',\n      'Kindle',\n      '360',\n      'UC',\n      'QQBrowser',\n      'QQ',\n      'Baidu',\n      'Maxthon',\n      'Sogou',\n      'LBBROWSER',\n      '2345Explorer',\n      'TheWorld',\n      'XiaoMi',\n      'Quark',\n      'Qiyu',\n      'Wechat',\n      'Taobao',\n      'Alipay',\n      'Weibo',\n      'Douban',\n      'Suning',\n      'iQiYi'\n    ],\n    os: [\n      'Windows',\n      'Linux',\n      'Mac OS',\n      'Android',\n      'Ubuntu',\n      'FreeBSD',\n      'Debian',\n      'iOS',\n      'Windows Phone',\n      'BlackBerry',\n      'MeeGo',\n      'Symbian',\n      'Chrome OS',\n      'WebOS'\n    ],\n    device: ['Mobile', 'Tablet']\n  }\n  _this.device = 'PC'\n  _this.language = (function () {\n    var g = nav.browserLanguage || nav.language\n    var arr = g.split('-')\n    if (arr[1]) {\n      arr[1] = arr[1].toUpperCase()\n    }\n    return arr.join('_')\n  })()\n  for (var s in hash) {\n    for (var i = 0; i < hash[s].length; i++) {\n      var value = hash[s][i]\n      if (match[value]) {\n        _this[s] = value\n      }\n    }\n  }\n  //系统版本信息\n  var osVersion = {\n    Windows: function () {\n      var v = u.replace(/^.*Windows NT ([\\d.]+);.*$/, '$1')\n      var hash = {\n        '6.4': '10',\n        '6.3': '8.1',\n        '6.2': '8',\n        '6.1': '7',\n        '6.0': 'Vista',\n        '5.2': 'XP',\n        '5.1': 'XP',\n        '5.0': '2000'\n      }\n      return hash[v] || v\n    },\n    Android: function () {\n      return u.replace(/^.*Android ([\\d.]+);.*$/, '$1')\n    },\n    iOS: function () {\n      return u.replace(/^.*OS ([\\d_]+) like.*$/, '$1').replace(/_/g, '.')\n    },\n    Debian: function () {\n      return u.replace(/^.*Debian\\/([\\d.]+).*$/, '$1')\n    },\n    'Windows Phone': function () {\n      return u.replace(/^.*Windows Phone( OS)? ([\\d.]+);.*$/, '$2')\n    },\n    'Mac OS': function () {\n      return u.replace(/^.*Mac OS X ([\\d_]+).*$/, '$1').replace(/_/g, '.')\n    },\n    WebOS: function () {\n      return u.replace(/^.*hpwOS\\/([\\d.]+);.*$/, '$1')\n    }\n  }\n  _this.osVersion = ''\n  if (osVersion[_this.os]) {\n    _this.osVersion = osVersion[_this.os]()\n    if (_this.osVersion == u) {\n      _this.osVersion = ''\n    }\n  }\n  //浏览器版本信息\n  var version = {\n    Safari: function () {\n      return u.replace(/^.*Version\\/([\\d.]+).*$/, '$1')\n    },\n    Chrome: function () {\n      return u.replace(/^.*Chrome\\/([\\d.]+).*$/, '$1').replace(/^.*CriOS\\/([\\d.]+).*$/, '$1')\n    },\n    IE: function () {\n      return u.replace(/^.*MSIE ([\\d.]+).*$/, '$1').replace(/^.*rv:([\\d.]+).*$/, '$1')\n    },\n    Edge: function () {\n      return u.replace(/^.*Edge\\/([\\d.]+).*$/, '$1')\n    },\n    Firefox: function () {\n      return u.replace(/^.*Firefox\\/([\\d.]+).*$/, '$1').replace(/^.*FxiOS\\/([\\d.]+).*$/, '$1')\n    },\n    'Firefox Focus': function () {\n      return u.replace(/^.*Focus\\/([\\d.]+).*$/, '$1')\n    },\n    Chromium: function () {\n      return u.replace(/^.*Chromium\\/([\\d.]+).*$/, '$1')\n    },\n    Opera: function () {\n      return u.replace(/^.*Opera\\/([\\d.]+).*$/, '$1').replace(/^.*OPR\\/([\\d.]+).*$/, '$1')\n    },\n    Vivaldi: function () {\n      return u.replace(/^.*Vivaldi\\/([\\d.]+).*$/, '$1')\n    },\n    Yandex: function () {\n      return u.replace(/^.*YaBrowser\\/([\\d.]+).*$/, '$1')\n    },\n    Kindle: function () {\n      return u.replace(/^.*Version\\/([\\d.]+).*$/, '$1')\n    },\n    Maxthon: function () {\n      return u.replace(/^.*Maxthon\\/([\\d.]+).*$/, '$1')\n    },\n    QQBrowser: function () {\n      return u.replace(/^.*QQBrowser\\/([\\d.]+).*$/, '$1')\n    },\n    QQ: function () {\n      return u.replace(/^.*QQ\\/([\\d.]+).*$/, '$1')\n    },\n    Baidu: function () {\n      return u.replace(/^.*BIDUBrowser[\\s\\/]([\\d.]+).*$/, '$1')\n    },\n    UC: function () {\n      return u.replace(/^.*UC?Browser\\/([\\d.]+).*$/, '$1')\n    },\n    Sogou: function () {\n      return u.replace(/^.*SE ([\\d.X]+).*$/, '$1').replace(/^.*SogouMobileBrowser\\/([\\d.]+).*$/, '$1')\n    },\n    '2345Explorer': function () {\n      return u.replace(/^.*2345Explorer\\/([\\d.]+).*$/, '$1')\n    },\n    TheWorld: function () {\n      return u.replace(/^.*TheWorld ([\\d.]+).*$/, '$1')\n    },\n    XiaoMi: function () {\n      return u.replace(/^.*MiuiBrowser\\/([\\d.]+).*$/, '$1')\n    },\n    Quark: function () {\n      return u.replace(/^.*Quark\\/([\\d.]+).*$/, '$1')\n    },\n    Qiyu: function () {\n      return u.replace(/^.*Qiyu\\/([\\d.]+).*$/, '$1')\n    },\n    Wechat: function () {\n      return u.replace(/^.*MicroMessenger\\/([\\d.]+).*$/, '$1')\n    },\n    Taobao: function () {\n      return u.replace(/^.*AliApp\\(TB\\/([\\d.]+).*$/, '$1')\n    },\n    Alipay: function () {\n      return u.replace(/^.*AliApp\\(AP\\/([\\d.]+).*$/, '$1')\n    },\n    Weibo: function () {\n      return u.replace(/^.*weibo__([\\d.]+).*$/, '$1')\n    },\n    Douban: function () {\n      return u.replace(/^.*com.douban.frodo\\/([\\d.]+).*$/, '$1')\n    },\n    Suning: function () {\n      return u.replace(/^.*SNEBUY-APP([\\d.]+).*$/, '$1')\n    },\n    iQiYi: function () {\n      return u.replace(/^.*IqiyiVersion\\/([\\d.]+).*$/, '$1')\n    }\n  }\n  _this.version = ''\n  if (version[_this.browser]) {\n    _this.version = version[_this.browser]()\n    if (_this.version == u) {\n      _this.version = ''\n    }\n  }\n  //修正\n  if (_this.browser == 'Edge') {\n    _this.engine = 'EdgeHTML'\n  } else if (_this.browser == 'Chrome' && parseInt(_this.version) > 27) {\n    _this.engine = 'Blink'\n  } else if (_this.browser == 'Opera' && parseInt(_this.version) > 12) {\n    _this.engine = 'Blink'\n  } else if (_this.browser == 'Yandex') {\n    _this.engine = 'Blink'\n  } else if (_this.browser == undefined) {\n    _this.browser = 'Unknow App'\n  }\n}\n\nfunction detectFactory(u) {\n  return new Detect(u)\n}\n\nexport default detectFactory\n","const HtmlUtil = {\n  /**\n   * HTML转码\n   * @param {String} str\n   * @return {String} result\n   */\n  encode(str) {\n    return !!str\n      ? str\n          .replace(/&/g, '&amp;')\n          .replace(/</g, '&lt;')\n          .replace(/>/g, '&gt;')\n          .replace(/ /g, '&nbsp;')\n          .replace(/\\'/g, '&#39;')\n          .replace(/\\\"/g, '&quot;')\n      : ''\n  },\n  /**\n   * HTML解码\n   * @param {String} str\n   * @return {String} result\n   */\n  decode(str) {\n    return !!str\n      ? str\n          .replace(/&amp;/g, '&')\n          .replace(/&lt;/g, '<')\n          .replace(/&gt;/g, '>')\n          .replace(/&nbsp;/g, ' ')\n          .replace(/&#39;/g, \"'\")\n          .replace(/&quot;/g, '\"')\n      : ''\n  }\n}\n\nconst dateFormat = date => {\n  const vDay = padWithZeros(date.getDate(), 2)\n  const vMonth = padWithZeros(date.getMonth() + 1, 2)\n  const vYear = padWithZeros(date.getFullYear(), 2)\n  return `${vYear}-${vMonth}-${vDay}`\n}\n\nconst timeAgo = date => {\n  try {\n    const oldTime = date.getTime()\n    const currTime = new Date().getTime()\n    const diffValue = currTime - oldTime\n\n    const days = Math.floor(diffValue / (24 * 3600 * 1000))\n    if (days === 0) {\n      //计算相差小时数\n      const leave1 = diffValue % (24 * 3600 * 1000) //计算天数后剩余的毫秒数\n      const hours = Math.floor(leave1 / (3600 * 1000))\n      if (hours === 0) {\n        //计算相差分钟数\n        const leave2 = leave1 % (3600 * 1000) //计算小时数后剩余的毫秒数\n        const minutes = Math.floor(leave2 / (60 * 1000))\n        if (minutes === 0) {\n          //计算相差秒数\n          const leave3 = leave2 % (60 * 1000) //计算分钟数后剩余的毫秒数\n          const seconds = Math.round(leave3 / 1000)\n          return seconds + ' 秒前'\n        }\n        return minutes + ' 分钟前'\n      }\n      return hours + ' 小时前'\n    }\n    if (days < 0) return '刚刚'\n\n    if (days < 8) {\n      return days + ' 天前'\n    } else {\n      return dateFormat(date)\n    }\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nconst padWithZeros = (vNumber, width) => {\n  let numAsString = vNumber.toString()\n  while (numAsString.length < width) {\n    numAsString = '0' + numAsString\n  }\n  return numAsString\n}\n\nconst Event = {\n  on(type, el, handler, capture) {\n    if (el.addEventListener) el.addEventListener(type, handler, capture || false)\n    else if (el.attachEvent) el.attachEvent(`on${type}`, handler)\n    else el[`on${type}`] = handler\n  },\n  off(type, el, handler, capture) {\n    if (el.removeEventListener) el.removeEventListener(type, handler, capture || false)\n    else if (el.detachEvent) el.detachEvent(`on${type}`, handler)\n    else el[`on${type}`] = null\n  }\n}\n\nconst getLink = target => {\n  return target.link || (target.mail && `mailto:${target.mail}`) || 'javascript:void(0);'\n}\n\nconst check = {\n  mail(m) {\n    return {\n      k: /[\\w-\\.]+@([\\w-]+\\.)+[a-z]{2,3}/.test(m),\n      v: m\n    }\n  },\n  link(l) {\n    l = l.length > 0 && (/^(http|https)/.test(l) ? l : `http://${l}`)\n    return {\n      k: /(http|https):\\/\\/[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\w\\-\\@?^=%&amp;/~\\+#])?/.test(l),\n      v: l\n    }\n  }\n}\n\nexport { HtmlUtil, Event, check, getLink, dateFormat, timeAgo }\n","/*\n * @Author: Ihoey\n * @Email: mail@ihoey.com\n * @Date: 2018-04-20 23:53:17\n * @LastEditors: Ihoey\n * @LastEditTime: 2020-06-26 17:59:27\n */\n\nimport md5 from 'blueimp-md5'\nimport marked from 'marked'\nimport detect from './detect'\nimport './Hitalk.scss'\nimport { version } from '../package.json'\nimport { HtmlUtil, Event, check, getLink, dateFormat, timeAgo } from './utils'\n\nconst gravatar = {\n  cdn: 'https://gravatar.loli.net/avatar/',\n  ds: ['mm', 'identicon', 'monsterid', 'wavatar', 'retro', ''],\n  params: '?s=40',\n  hide: !1\n}\nconst defaultComment = {\n  comment: '',\n  rid: '',\n  nick: 'Guest',\n  mail: '',\n  link: '',\n  ua: navigator.userAgent,\n  url: '',\n  pin: 0,\n  like: 0\n}\nconst GUEST_INFO = ['nick', 'mail', 'link']\nconst store = localStorage\n\nconst smiliesData = {\n  泡泡: `呵呵|哈哈|吐舌|太开心|笑眼|花心|小乖|乖|捂嘴笑|滑稽|你懂的|不高兴|怒|汗|黑线|泪|真棒|喷|惊哭|阴险|鄙视|酷|啊|狂汗|what|疑问|酸爽|呀咩爹|委屈|惊讶|睡觉|笑尿|挖鼻|吐|犀利|小红脸|懒得理|勉强|爱心|心碎|玫瑰|礼物|彩虹|太阳|星星月亮|钱币|茶杯|蛋糕|大拇指|胜利|haha|OK|沙发|手纸|香蕉|便便|药丸|红领巾|蜡烛|音乐|灯泡|开心|钱|咦|呼|冷|生气|弱`,\n  阿鲁: `高兴|小怒|脸红|内伤|装大款|赞一个|害羞|汗|吐血倒地|深思|不高兴|无语|亲亲|口水|尴尬|中指|想一想|哭泣|便便|献花|皱眉|傻笑|狂汗|吐|喷水|看不见|鼓掌|阴暗|长草|献黄瓜|邪恶|期待|得意|吐舌|喷血|无所谓|观察|暗地观察|肿包|中枪|大囧|呲牙|抠鼻|不说话|咽气|欢呼|锁眉|蜡烛|坐等|击掌|惊喜|喜极而泣|抽烟|不出所料|愤怒|无奈|黑线|投降|看热闹|扇耳光|小眼睛|中刀`\n}\nconst pReg = new RegExp('\\\\@\\\\(\\\\s*(' + smiliesData.泡泡 + ')\\\\s*\\\\)')\nconst aReg = new RegExp('\\\\#\\\\(\\\\s*(' + smiliesData.阿鲁 + ')\\\\s*\\\\)')\nlet subfix = ''\nif (window.devicePixelRatio != undefined && window.devicePixelRatio >= 1.49) {\n  subfix = '@2x'\n}\n\nclass Hitalk {\n  constructor(option) {\n    this.md5 = md5\n    this.version = version\n\n    const av = option.av || AV\n    const appId = option.app_id || option.appId\n    const appKey = option.app_key || option.appKey\n    const serverURLs = option.serverURLs || 'https://hitalk.dode.top'\n\n    if (!appId || !appKey) {\n      this.throw('初始化失败，请检查你的appid或者appkey.')\n    }\n\n    av.init({ appId, appKey, serverURLs })\n    this.v = av\n\n    defaultComment.url = (option.path || location.pathname).replace(/index\\.(html|htm)/, '')\n    // 分页\n    this.pageSize = option.pageSize || 10\n    this.page = 0\n    // 评论数\n    this.initCount()\n    // 初始化评论\n    !!option && this.init(option)\n  }\n\n  throw(msg) {\n    throw new Error(`Hitalk: ${msg}`)\n  }\n\n  init(option) {\n    try {\n      // get el\n      let el =\n        {}.toString.call(option.el) === '[object HTMLDivElement]' ? option.el : document.querySelectorAll(option.el)[0]\n      if ({}.toString.call(el) != '[object HTMLDivElement]') {\n        this.throw(`The target element was not found.`)\n      }\n      this.el = el\n      this.el.classList.add('Hitalk')\n\n      // 自定义 header\n      const guest_info = option.guest_info || GUEST_INFO\n      const inputEl = guest_info.map(item => {\n        switch (item) {\n          case 'nick':\n            return '<input name=\"nick\" placeholder=\"称呼\" class=\"vnick vinput\" type=\"text\">'\n          case 'mail':\n            return '<input name=\"mail\" placeholder=\"邮箱(会收到提醒哦~)\" class=\"vmail vinput\" type=\"email\">'\n          case 'link':\n            return '<input name=\"link\" placeholder=\"网址 http(s)://\" class=\"vlink vinput\" type=\"text\">'\n          default:\n            return ''\n        }\n      })\n\n      // 填充元素\n      let placeholder = option.placeholder || ''\n      let eleHTML = `\n      <div class=\"vwrap\">\n          <div class=\"welcome dn\">欢迎回来，{name}！<span class=\"info-edit\">修改</span></div>\n          <div class=\"${`vheader item${inputEl.length}`}\">${inputEl.join('')}</div>\n          <div class=\"vedit\">\n              <textarea class=\"veditor vinput\" placeholder=\"${placeholder}\"></textarea>\n          </div>\n          <div class=\"vcontrol\">\n              <span class=\"col col-60 smilies\">\n                  <div class=\"col smilies-logo\"><span>^_^</span></div>\n                  <div class=\"col\" title=\"Markdown is Support\">MarkDown is Support</div>\n                  <div class=\"smilies-body\"></div>\n              </span>\n              <div class=\"col col-40 text-right\">\n                  <button type=\"button\" class=\"vsubmit vbtn\">回复</button>\n              </div>\n          </div>\n          <div class=\"vmark dn\"></div>\n      </div>\n      <div class=\"info\">\n          <div class=\"count col\"></div>\n      </div>\n      <div class=\"vloading\"></div>\n      <div class=\"vempty dn\"></div>\n      <ul class=\"vlist\"></ul>\n      <div class=\"vpage txt-right\"></div>`\n\n      this.el.innerHTML = eleHTML\n\n      // Empty Data\n      let vempty = this.el.querySelector('.vempty')\n      const nodata = {\n        show(txt = '还没有评论哦，快来抢沙发吧!') {\n          vempty.innerHTML = txt\n          vempty.classList.remove('dn')\n        },\n        hide() {\n          vempty.classList.add('dn')\n        }\n      }\n\n      // loading\n      let _spinner = `<div class=\"spinner\"><div class=\"r1\"></div><div class=\"r2\"></div><div class=\"r3\"></div><div class=\"r4\"></div><div class=\"r5\"></div></div>`\n      let vloading = this.el.querySelector('.vloading')\n      vloading.innerHTML = _spinner\n      // loading control\n      this.loading = {}\n      this.loading.show = () => {\n        vloading.classList.remove('dn')\n        nodata.hide()\n      }\n      this.loading.hide = () => {\n        vloading.classList.add('dn')\n        el.querySelectorAll('.vcard').length === 0 && nodata.show()\n      }\n\n      gravatar['params'] = '?d=' + (gravatar['ds'].indexOf(option.avatar) > -1 ? option.avatar : 'mm')\n      gravatar['hide'] = option.avatar === 'hide' ? !0 : !1\n    } catch (ex) {\n      let issue = 'https://github.com/ihoey/Hitalk/issues'\n      if (this.el)\n        nodata.show(\n          `<pre style=\"color:red;text-align:left;\">${ex}<br>Hitalk:<b>${this.version}</b><br>反馈：${issue}</pre>`\n        )\n      else\n        console &&\n          console.log(\n            `%c${ex}\\n%cHitalk%c${this.version} ${issue}`,\n            'color:red;',\n            'background:#000;padding:5px;line-height:30px;color:#fff;',\n            'background:#456;line-height:30px;padding:5px;color:#fff;'\n          )\n      return\n    }\n\n    let _mark = this.el.querySelector('.vmark')\n    // alert\n    this.alert = {}\n    this.alert.show = o => {\n      _mark.innerHTML = `<div class=\"valert txt-center\"><div class=\"vtext\">${o.text}</div><div class=\"vbtns\"></div></div>`\n      let _vbtns = _mark.querySelector('.vbtns')\n      let _cBtn = `<button class=\"vcancel vbtn\">${(o && o.ctxt) || '我再看看'}</button>`\n      let _oBtn = `<button class=\"vsure vbtn\">${(o && o.otxt) || '继续提交'}</button>`\n      _vbtns.innerHTML = `${_cBtn}${o.type && _oBtn}`\n      _mark.querySelector('.vcancel').addEventListener('click', e => {\n        this.alert.hide()\n      })\n      _mark.classList.remove('dn')\n      if (o && o.type) {\n        let _ok = _mark.querySelector('.vsure')\n        Event.on('click', _ok, e => {\n          this.alert.hide()\n          o.cb && o.cb()\n        })\n      }\n    }\n    this.alert.hide = () => {\n      _mark.classList.add('dn')\n    }\n\n    // Bind Event\n    this.bind(option)\n  }\n\n  commonQuery(url) {\n    let query = new this.v.Query('Comment')\n    query.equalTo('url', url || defaultComment['url']).descending('createdAt')\n    return query\n  }\n\n  initCount() {\n    const pCount = document.querySelectorAll('.hitalk-comment-count')\n    if (!pCount.length) return false\n\n    const vArr = []\n    const urlArr = []\n\n    for (let i = 0; i < pCount.length; i++) {\n      const el = pCount[i]\n      const url = el.getAttribute('data-xid').replace(/index\\.(html|htm)/, '')\n\n      urlArr[i] = url\n      vArr[i] = this.commonQuery(url)\n    }\n\n    const cq = new this.v.Query.or(...vArr)\n    cq.select('url')\n      .limit(1000)\n      .find()\n      .then(res => {\n        urlArr.map((e, i) => (pCount[i].innerText = res.filter(x => e === x.get('url')).length))\n      })\n      .catch(ex => {\n        this.throw(ex)\n      })\n  }\n  /**\n   * Bind Event\n   */\n  bind(option) {\n    let guest_info = (option.guest_info || GUEST_INFO).filter(item => GUEST_INFO.indexOf(item) > -1)\n\n    let expandEvt = el => {\n      if (el.offsetHeight > 180) {\n        el.classList.add('expand')\n        Event.on('click', el, e => {\n          el.setAttribute('class', 'vcontent')\n        })\n      }\n    }\n\n    let insertDom = (ret, mt) => {\n      let _vcard = document.createElement('li')\n      _vcard.setAttribute('class', 'vcard')\n      _vcard.setAttribute('id', ret.id)\n      let _ua = detect(ret.get('ua'))\n      let _img = gravatar['hide']\n        ? ''\n        : `<img class=\"vimg\" src='${gravatar.cdn + md5(ret.get('mail') || ret.get('nick')) + gravatar.params}'>`\n      _vcard.innerHTML = `${_img}<section><div class=\"vhead\"><a rel=\"nofollow\" href=\"${getLink({\n        link: ret.get('link'),\n        mail: ret.get('mail')\n      })}\" target=\"_blank\" >${ret.get('nick')}</a>\n      <span class=\"vsys\">${_ua.os} ${_ua.osVersion}</span>\n      <span class=\"vsys\">${_ua.browser} ${_ua.version}</span>\n      </div><div class=\"vcontent\">${ret.get('comment')}</div><div class=\"vfooter\"><span class=\"vtime\">${timeAgo(\n        ret.get('createdAt')\n      )}</span><span rid='${ret.id}' at='@${ret.get('nick')}' mail='${ret.get(\n        'mail'\n      )}' class=\"vat\">回复</span><div></section>`\n\n      let _vlist = this.el.querySelector('.vlist')\n      let _vlis = _vlist.querySelectorAll('li')\n      let _vat = _vcard.querySelector('.vat')\n      let _as = _vcard.querySelectorAll('a')\n      for (let i = 0, len = _as.length; i < len; i++) {\n        let item = _as[i]\n        if (item && item.getAttribute('class') != 'at') {\n          item.setAttribute('target', '_blank')\n          item.setAttribute('rel', 'nofollow')\n        }\n      }\n      if (mt) _vlist.appendChild(_vcard)\n      else _vlist.insertBefore(_vcard, _vlis[0])\n      let _vcontent = _vcard.querySelector('.vcontent')\n      expandEvt(_vcontent)\n      bindAtEvt(_vat)\n    }\n\n    // 填充表情节点\n    let addSmilies = () => {\n      let _smilies = this.el.querySelector('.smilies-body')\n      let _ul,\n        _li = ''\n      let fragment = document.createDocumentFragment()\n      const sl = '泡泡'\n      Object.keys(smiliesData).forEach((y, i) => {\n        _ul = document.createElement('ul')\n        _ul.setAttribute('class', 'smilies-items smilies-items-biaoqing' + (y == sl ? ' smilies-items-show' : ''))\n        _ul.setAttribute('data-id', i)\n        smiliesData[y].split('|').forEach(e => {\n          _ul.innerHTML += `<li class=\"smilies-item\" title=\"${e}\" data-input=\"${\n            (y == sl ? '@' : '#') + `(${e})`\n          }\"><img class=\"biaoqing ${y == sl ? 'newpaopao' : 'alu'}\" title=\"${e}\" src=\"https://cdn.dode.top/${\n            y == sl ? 'newpaopao' : 'alu'\n          }/${e + subfix}.png\"></li>`\n        })\n        _li += `<li class=\"smilies-name ${\n          y == sl ? 'smilies-package-active' : ''\n        }\" data-id=\"${i}\"><span>${y}</span></li>`\n        fragment.appendChild(_ul) //添加ul\n      })\n      let _div = document.createElement('div')\n      _div.setAttribute('class', 'smilies-bar')\n      _div.innerHTML = `<ul class=\"smilies-packages\">${_li}</ul>`\n      fragment.appendChild(_div) //再次添加div\n      _smilies.appendChild(fragment)\n\n      let smilies = document.querySelector('.smilies')\n      let _el = document.querySelector('.veditor')\n\n      Event.on('click', smilies, e => {\n        e = e.target\n        if (e.className == 'smilies-item') {\n          _el.value += ` ${e.getAttribute('data-input')} `\n          defaultComment.comment = marked(_el.value, {\n            sanitize: !0,\n            breaks: !0\n          })\n          smilies.classList.remove('smilies-open')\n        } else if (e.classList.contains('smilies-logo')) {\n          smilies.classList.toggle('smilies-open')\n        } else if (e.classList.contains('smilies-name')) {\n          if (!e.classList.contains('smilies-package-active')) {\n            document.querySelectorAll('.smilies-name').forEach(e => e.classList.remove('smilies-package-active'))\n            document.querySelectorAll('.smilies-items').forEach(e => e.classList.remove('smilies-items-show'))\n            document.querySelectorAll('.smilies-items')[e.getAttribute('data-id')].classList.add('smilies-items-show')\n            e.classList.add('smilies-package-active')\n          }\n        }\n      })\n\n      Event.on('mouseup', document, e => {\n        e = e.target\n        let _con = document.querySelector('.smilies')\n        if (!_con === e || !_con.contains(e)) {\n          smilies.classList.remove('smilies-open')\n        }\n      })\n    }\n\n    let query = () => {\n      this.loading.show()\n      addSmilies() // 填充表情\n      let cq = this.commonQuery()\n      cq.limit(this.pageSize)\n        .skip(this.page * this.pageSize)\n        .find()\n        .then(rets => {\n          let len = rets.length\n          if (len) {\n            this.el.querySelector('.vlist').innerHTML = ''\n            for (let i = 0; i < len; i++) {\n              insertDom(rets[i], !0)\n            }\n            let _count = this.el.querySelector('.num')\n            if (!_count) {\n              cq.count().then(len => {\n                const _pageCount = Math.ceil(len / this.pageSize)\n                this.el.querySelector('.count').innerHTML = `评论(<span class=\"num\">${len}</span>)`\n\n                const _pageDom = (_class, _text) => `<span class=\"${_class} page-numbers\">${_text}</span>`\n                let vpageDom = _pageDom('prev dn', '&lt;')\n                for (let index = 1; index <= _pageCount; index++) {\n                  vpageDom += _pageDom(`numbers ${index == 1 ? 'current' : ''}`, index)\n                }\n                vpageDom += _pageDom('next dn', '&gt;')\n                this.el.querySelector('.vpage').innerHTML = vpageDom\n\n                pageHandle(len)\n\n                Event.on('click', this.el.querySelector('.vpage'), e => {\n                  const inc = v => e.target.className.split(' ').includes(v)\n                  if (inc('current') || inc('vpage')) {\n                    return\n                  }\n                  if (inc('numbers')) {\n                    this.page = Number(e.target.innerText) - 1\n                  } else if (inc('prev')) {\n                    this.page--\n                  } else if (inc('next')) {\n                    this.page++\n                  }\n                  query()\n                })\n              })\n            } else {\n              pageHandle(_count.innerText)\n            }\n          }\n          this.loading.hide()\n        })\n        .catch(ex => {\n          this.loading.hide()\n          this.throw(ex)\n        })\n    }\n    query()\n\n    let pageHandle = _count => {\n      if (this.el.querySelector('.vpage .numbers.current')) {\n        this.el.querySelector('.vpage .numbers.current').classList.remove('current')\n      }\n      this.el.querySelectorAll('.vpage .numbers')[this.page].classList.add('current')\n\n      const domClass = {\n        0: '.prev',\n        [Math.ceil(_count / this.pageSize, 10) - 1]: '.next'\n      }\n\n      Object.values(domClass).map(e => this.el.querySelector(`.vpage ${e}`).classList.remove('dn'))\n      if (domClass[this.page]) {\n        this.el.querySelector(`.vpage ${domClass[this.page]}`).classList.add('dn')\n        return\n      }\n    }\n\n    let mapping = {\n      veditor: 'comment'\n    }\n    for (let i = 0, length = guest_info.length; i < length; i++) {\n      mapping[`v${guest_info[i]}`] = guest_info[i]\n    }\n\n    let inputs = {}\n    for (let i in mapping) {\n      if (mapping.hasOwnProperty(i)) {\n        let _v = mapping[i]\n        let _el = this.el.querySelector(`.${i}`)\n        inputs[_v] = _el\n        Event.on('input', _el, e => {\n          defaultComment[_v] =\n            _v === 'comment'\n              ? marked(_el.value, {\n                  sanitize: !0,\n                  breaks: !0\n                })\n              : HtmlUtil.encode(_el.value)\n        })\n      }\n    }\n\n    // cache\n    let getCache = () => {\n      let s = store && store.HitalkCache\n      if (s) {\n        s = JSON.parse(s)\n        let m = guest_info\n        for (let i in m) {\n          let k = m[i]\n          this.el.querySelector(`.v${k}`).value = s[k]\n          defaultComment[k] = s[k]\n        }\n        const welcome = this.el.querySelector(`.welcome`).innerHTML\n        this.el.querySelector(`.welcome`).classList.remove('dn')\n        this.el.querySelector(`.welcome`).innerHTML = welcome.replace('{name}', s['nick'])\n        this.el.querySelector(`.vheader`).classList.add('hide')\n        Event.on('click', this.el.querySelector(`.welcome .info-edit`), e => {\n          this.el.querySelector(`.vheader`).classList.toggle('hide')\n        })\n      }\n    }\n    getCache()\n\n    let atData = {\n      rmail: '',\n      at: ''\n    }\n\n    // reset form\n    let reset = () => {\n      for (let i in mapping) {\n        if (mapping.hasOwnProperty(i)) {\n          let _v = mapping[i]\n          let _el = this.el.querySelector(`.${i}`)\n          _el.value = ''\n          defaultComment[_v] = ''\n        }\n      }\n      atData['at'] = ''\n      atData['rmail'] = ''\n      defaultComment['rid'] = ''\n      defaultComment['nick'] = 'Guest'\n      getCache()\n    }\n\n    // submit\n    let submitBtn = this.el.querySelector('.vsubmit')\n    let submitEvt = e => {\n      if (submitBtn.getAttribute('disabled')) {\n        this.alert.show({\n          type: '',\n          text: '再等等，评论正在提交中ヾ(๑╹◡╹)ﾉ\"',\n          ctxt: '好的'\n        })\n        return\n      }\n      if (defaultComment.comment == '') {\n        inputs['comment'].focus()\n        this.alert.show({\n          type: '',\n          text: '好歹也写点文字嘛ヾ(๑╹◡╹)ﾉ\"',\n          ctxt: '好的'\n        })\n        return\n      }\n      if (defaultComment.nick == '') {\n        defaultComment['nick'] = '小调皮'\n      }\n      let idx = defaultComment.comment.indexOf(atData.at)\n      if (idx > -1 && atData.at != '') {\n        let at = `<a class=\"at\" href='#${defaultComment.rid}'>${atData.at}</a>`\n        defaultComment.comment = defaultComment.comment.replace(atData.at, at)\n      }\n      //表情\n      var matched\n      while ((matched = defaultComment.comment.match(pReg))) {\n        defaultComment.comment = defaultComment.comment.replace(\n          matched[0],\n          `<img src=\"https://cdn.dode.top/newpaopao/${\n            matched[1] + subfix\n          }.png\" class=\"biaoqing newpaopao\" height=30 width=30 no-zoom />`\n        )\n      }\n      while ((matched = defaultComment.comment.match(aReg))) {\n        defaultComment.comment = defaultComment.comment.replace(\n          matched[0],\n          `<img src=\"https://cdn.dode.top/alu/${\n            matched[1] + subfix\n          }.png\" class=\"biaoqing alu\" height=33 width=33 no-zoom />`\n        )\n      }\n\n      // veirfy\n      let mailRet = check.mail(defaultComment.mail)\n      let linkRet = check.link(defaultComment.link)\n      defaultComment['mail'] = mailRet.k ? mailRet.v : ''\n      defaultComment['link'] = linkRet.k ? linkRet.v : ''\n      const alertShow = text => {\n        this.alert.show({\n          type: 1,\n          text,\n          cb: () => commitEvt()\n        })\n      }\n\n      if (!mailRet.k && !linkRet.k && guest_info.indexOf('mail') > -1 && guest_info.indexOf('link') > -1) {\n        alertShow('您的网址和邮箱格式不正确, 是否继续提交?')\n      } else if (!mailRet.k && guest_info.indexOf('mail') > -1) {\n        alertShow('您的邮箱格式不正确, 是否继续提交?')\n      } else if (!linkRet.k && guest_info.indexOf('link') > -1) {\n        alertShow('您的网址格式不正确, 是否继续提交?')\n      } else {\n        commitEvt()\n      }\n    }\n\n    // setting access\n    let getAcl = () => {\n      let acl = new this.v.ACL()\n      acl.setPublicReadAccess(!0)\n      acl.setPublicWriteAccess(!1)\n      return acl\n    }\n\n    let commitEvt = () => {\n      submitBtn.setAttribute('disabled', !0)\n      this.loading.show()\n      // 声明类型\n      let Ct = this.v.Object.extend('Comment')\n      // 新建对象\n      let comment = new Ct()\n      for (let i in defaultComment) {\n        if (defaultComment.hasOwnProperty(i)) {\n          let _v = defaultComment[i]\n          comment.set(i, _v)\n        }\n      }\n      comment.setACL(getAcl())\n      comment\n        .save()\n        .then(ret => {\n          defaultComment['nick'] != 'Guest' &&\n            store &&\n            store.setItem(\n              'HitalkCache',\n              JSON.stringify({\n                nick: defaultComment['nick'],\n                link: defaultComment['link'],\n                mail: defaultComment['mail']\n              })\n            )\n          let _count = this.el.querySelector('.num')\n          let num = 1\n          try {\n            if (_count) {\n              num = Number(_count.innerText) + 1\n              _count.innerText = num\n            } else {\n              this.el.querySelector('.count').innerHTML = '评论(<span class=\"num\">1</span>)'\n            }\n            insertDom(ret)\n\n            defaultComment['mail'] &&\n              signUp({\n                username: defaultComment['nick'],\n                mail: defaultComment['mail']\n              })\n\n            submitBtn.removeAttribute('disabled')\n            this.loading.hide()\n            reset()\n          } catch (error) {\n            console.log(error)\n          }\n        })\n        .catch(ex => {\n          this.loading.hide()\n          this.throw(ex)\n        })\n    }\n\n    let signUp = o => {\n      let u = new this.v.User()\n      u.setUsername(o.username)\n      u.setPassword(o.mail)\n      u.setEmail(o.mail)\n      u.setACL(getAcl())\n      return u.signUp()\n    }\n\n    // at event\n    let bindAtEvt = el => {\n      Event.on('click', el, e => {\n        let at = el.getAttribute('at')\n        let rid = el.getAttribute('rid')\n        let rmail = el.getAttribute('mail')\n        atData['at'] = at\n        atData['rmail'] = rmail\n        defaultComment['rid'] = rid\n        inputs['comment'].value = `${at} `\n        inputs['comment'].focus()\n      })\n    }\n\n    Event.off('click', submitBtn, submitEvt)\n    Event.on('click', submitBtn, submitEvt)\n  }\n}\n\nexport default Hitalk\n"],"names":["win","window","nav","navigator","Detect","userAgent","u","_this","match","Trident","indexOf","Presto","WebKit","Gecko","Safari","Chrome","IE","Edge","Firefox","Chromium","Opera","Vivaldi","Yandex","Kindle","UC","QQBrowser","QQ","Baidu","Maxthon","Sogou","LBBROWSER","TheWorld","XiaoMi","Quark","Qiyu","Wechat","Taobao","Alipay","Weibo","Douban","Suning","iQiYi","Windows","Linux","Android","Ubuntu","FreeBSD","Debian","BlackBerry","MeeGo","Symbian","iOS","WebOS","Mobile","Tablet","showModalDialog","chrome","hash","engine","browser","os","device","language","g","browserLanguage","arr","split","toUpperCase","join","s","i","length","value","osVersion","v","replace","version","parseInt","undefined","detectFactory","const","HtmlUtil","encode","str","decode","dateFormat","date","vDay","padWithZeros","getDate","vMonth","getMonth","vYear","getFullYear","timeAgo","oldTime","getTime","currTime","Date","diffValue","days","Math","floor","leave1","hours","leave2","minutes","leave3","seconds","round","error","console","log","vNumber","width","numAsString","toString","Event","on","type","el","handler","capture","addEventListener","attachEvent","off","removeEventListener","detachEvent","getLink","target","link","mail","check","m","k","test","l","gravatar","cdn","ds","params","hide","defaultComment","comment","rid","nick","ua","url","pin","like","GUEST_INFO","store","localStorage","smiliesData","泡泡","阿鲁","pReg","RegExp","aReg","let","subfix","devicePixelRatio","Hitalk","constructor","option","md5","av","AV","appId","app_id","appKey","app_key","serverURLs","throw","init","path","location","pathname","pageSize","page","initCount","msg","Error","call","document","querySelectorAll","classList","add","guest_info","inputEl","map","item","placeholder","eleHTML","innerHTML","vempty","querySelector","nodata","show","txt","remove","_spinner","vloading","loading","avatar","ex","issue","_mark","alert","o","text","_vbtns","_cBtn","ctxt","_oBtn","otxt","e","_ok","cb","bind","commonQuery","query","Query","equalTo","descending","pCount","vArr","urlArr","getAttribute","cq","or","select","limit","find","then","res","innerText","filter","x","get","catch","expandEvt","offsetHeight","setAttribute","insertDom","ret","mt","_vcard","createElement","id","_ua","detect","_img","_vlist","this","_vlis","_vat","_as","len","appendChild","insertBefore","_vcontent","bindAtEvt","addSmilies","_smilies","_ul","_li","fragment","createDocumentFragment","sl","Object","keys","forEach","y","_div","smilies","_el","className","marked","sanitize","breaks","contains","toggle","_con","skip","rets","_count","count","_pageCount","ceil","_pageDom","_class","_text","vpageDom","index","pageHandle","inc","includes","Number","domClass","values","mapping","veditor","inputs","hasOwnProperty","_v","getCache","HitalkCache","JSON","parse","welcome","atData","rmail","at","reset","submitBtn","submitEvt","focus","idx","matched","mailRet","linkRet","alertShow","commitEvt","getAcl","acl","ACL","setPublicReadAccess","setPublicWriteAccess","Ct","extend","set","setACL","save","setItem","stringify","num","signUp","username","removeAttribute","User","setUsername","setPassword","setEmail"],"mappings":"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"}